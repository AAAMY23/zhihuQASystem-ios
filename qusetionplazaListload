#import "qusetionplazaListload.h"
#import "questionPlazaLoaditem.h"
@implementation qusetionplazaListload
    -(void)loadlistDataFinishWithBlock:(loadlistDataFinishblock)finishBlock{
        @try{
            NSURL *questionUrl=[NSURL URLWithString:@"http://8.136.142.201:9090/question/queryAll"];
        NSURLSession *questionSession=[NSURLSession sharedSession];
        NSURLSessionTask *questionDatatask=[questionSession dataTaskWithRequest:[NSURLRequest requestWithURL:questionUrl] completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) {
            NSDictionary *questionData=[NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:nil];
            //data-questionList-title 获取title数据
            NSDictionary *datadic=questionData[@"data"];
            NSArray *questionListArray=[datadic objectForKey:@"questionList"];
            //获得目前问题列表的问题数量
            //将获取的resonse数据解析后放在listArray中 目前只解析了title
            NSMutableArray *listArray=[[NSMutableArray alloc]init];
            for(NSDictionary *str in questionListArray){
                questionPlazaLoaditem *list=[[questionPlazaLoaditem alloc]init];
                [list configWithDictonary:str];
                [listArray addObject:list];
            }
            dispatch_async(dispatch_get_main_queue(), ^{
            if(finishBlock){
                finishBlock(error==nil,listArray.copy);
            }
            });
       }];
        [questionDatatask resume];
    }
        @catch(NSException *e){
            NSLog(@"参数为空");
        }
}


@end
